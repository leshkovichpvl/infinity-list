{"version":3,"file":"LoadableDataObject.js","sourceRoot":"","sources":["../src/LoadableDataObject.ts"],"names":[],"mappings":"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","sourcesContent":["\nexport class LoadableDataPackObject<T> {\n\n    static createInstance<T>(startIndex: number, stopIndex: number, items: T[]) {\n        return new LoadableDataPackObject<T>(startIndex, stopIndex, items);\n    }\n\n    constructor(\n        public startIndex: number,\n        public stopIndex: number,\n        public items: T[]\n    ) {}\n\n    hasIndex(index: number) {\n        return -1 !== this.getRange().indexOf(index);\n    }\n\n    getItem(index: number): T {\n        const pathIndex = this.getRange().indexOf(index);\n\n        return this.items[pathIndex];\n    }\n\n    incrementIndexes(count = 1): LoadableDataPackObject<T> {\n        return this.set('startIndex', this.startIndex + count).set('stopIndex', this.stopIndex + count);\n    }\n\n    private set(k: string, v: any): LoadableDataPackObject<T> {\n        this[k] = v;\n\n        return this;\n    }\n\n    private getRange(): number[] {\n        return Array.from(Array(this.stopIndex + 1).keys()).slice(this.startIndex);\n    };\n}\n\nexport class LoadableDataObject<T> {\n\n    static createInstance<T>(dataCount: number, packs: LoadableDataPackObject<T>[]) {\n        return new LoadableDataObject<T>(dataCount, packs);\n    }\n\n    static createNullInstance<T>() {\n        return new LoadableDataObject<T>(0, []);\n    }\n\n    constructor(\n        public dataCount: number,\n        public packs: LoadableDataPackObject<T>[] = []\n    ) {}\n\n    addPack(pack: LoadableDataPackObject<T>): LoadableDataObject<T> {\n\n        if (this.hasIndex([pack.startIndex, pack.stopIndex])) {\n            throw new Error(`Fail Add Pack: wrong indexes startIndex ${pack.startIndex} or stopIndex ${pack.stopIndex}`);\n        }\n\n        return this.set('packs', this.packs.concat([pack]));\n    }\n\n    setDataCount(count: number): LoadableDataObject<T> {\n        return this.set('dataCount', count);\n    }\n\n    unShiftList(list: T[]): LoadableDataObject<T> {\n        const packs = this.packs;\n\n        packs\n            .reduce((newList: LoadableDataPackObject<T>[], pack: LoadableDataPackObject<T>) => newList.concat([pack.incrementIndexes(list.length)]), [])\n            .unshift(LoadableDataPackObject.createInstance(0, list.length - 1, list))\n        ;\n\n        return this.set('packs', packs).incrementDataCount(list.length);\n    }\n\n    unShiftOne(item: T): LoadableDataObject<T> {\n        const packs = this.packs;\n\n        packs\n            .reduce((newList: LoadableDataPackObject<T>[], pack: LoadableDataPackObject<T>) => newList.concat([pack.incrementIndexes()]), [])\n            .unshift(LoadableDataPackObject.createInstance(0, 0, [item]))\n        ;\n\n        return this.set('packs', packs).incrementDataCount();\n    }\n\n    incrementDataCount(count = 1): LoadableDataObject<T> {\n        return this.setDataCount(this.dataCount + count);\n    }\n\n    getList(): T[] {\n        return this.packs.reduce((list: T[], pack: LoadableDataPackObject<T>) => list.concat(pack.items), []);\n    }\n\n    findByIndex(index: number): T | null {\n        const pack = this.getPackByIndex(index);\n\n        return pack ? pack.getItem(index) : null;\n    }\n\n    hasIndex(value: number | [number, number]) {\n\n        if (Array.isArray(value)) {\n            const [startIndex, stopIndex] = value;\n\n            return !!this.getPackByIndex(startIndex) || !!this.getPackByIndex(stopIndex);\n        }\n\n        return !!this.getPackByIndex(value);\n    }\n\n    private set(k: string, v: any): LoadableDataObject<T> {\n        this[k] = v;\n\n        return this;\n    }\n\n    private getPackByIndex(index: number): LoadableDataPackObject<T> | void {\n        return this.packs.find(pack => pack && pack.hasIndex(index));\n    };\n\n}\n"]}